How many users are there?

SELECT COUNT(DISTINCT user_id) FROM clique_bait.users; 
-- 500 users

How many cookies does each user have on average?

SELECT AVG(sub.cookie_count) AS avg_cookies
FROM (
SELECT user_id, COUNT(cookie_id) AS cookie_count 
FROM clique_bait.users
GROUP BY 1) sub;
-- On average, each user has 3.564 cookies.

What is the unique number of visits by all users per month?

SELECT EXTRACT('month' FROM event_time) AS visit_month, COUNT(DISTINCT visit_id) AS num_visits
FROM clique_bait.events
GROUP BY 1;

/* 
   Month 1 -> 876 visits
   Month 2 -> 1488
   Month 3 -> 916
   Month 4 -> 248
   Month 5 -> 36
*/

What is the number of events for each event type?

SELECT ev.event_type, evid.event_name, COUNT(ev.event_type) AS num_events
FROM clique_bait.events ev
JOIN clique_bait.event_identifier evid
ON ev.event_type = evid.event_type
GROUP BY 1, 2
ORDER BY 1;

/* 
   1	Page View	20928 events
   2	Add to Cart	8451
   3	Purchase	1777
   4	Ad Impression	876
   5	Ad Click	702
*/

What is the percentage of visits which have a purchase event?

What is the percentage of visits which view the checkout page but do not have a purchase event?

What are the top 3 pages by number of views?

What is the number of views and cart adds for each product category?

What are the top 3 products by purchases?
